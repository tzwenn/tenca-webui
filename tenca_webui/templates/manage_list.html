{% extends 'base.html' %}

{% block additional_scripts %}
<script src="{{ url_for('static', filename='js/tenca_manage_list.js') }}"></script>
{% endblock %}


{% block header %}
{% block title %}Manage List{% endblock %}
{% endblock %}

{% block content %}
{% import '_macros.html' as tenca_macros %}

<p>This is the admin view for the owners of {{ tenca_macros.css_codify(mailing_list.fqdn_listname) }}.</p>

<h4 class="title is-4">Invite Link</h4>

<p>Share this link to invite new members: </p>
<p>
{{ tenca_macros.copyable_link_box('invite_link', url_for('change_membership.index', hash_id=mailing_list.hash_id, _external=True)) }}
</p>

<p>
<h4 class="title is-4">Options</h4>
{% for name, description, value in list_bool_options %}
<form>
<div class="box">
	<div class="columns">
		<div class="column">
			{{ description }}
		</div>
		<div class="column is-3 has-text-right">
			<div class="buttons has-addons is-right">
				<button class="button{{ ' is-success is-selected' if value else ''}}">Yes</button>
				<button class="button{{ ' is-danger is-selected' if not value else ''}}">No</button>
			</div>
		</div>
	</div>
</div>
</form>
{% endfor %}
</p>


<p>
<h4 class="title is-4">Members</h4>

{% for address, is_owner in mailing_list.get_owners_and_members() %}
<form>
	<div class="box">
		<div class="columns">
			<div class="column">
				{{ tenca_macros.css_codify(address) }}
			</div>
			<div class="column is-3 has-text-right">
				<button class="button icon is-primary{{ '' if is_owner else 'is-outlined' }}" title="{{ 'Demote from Owner' if is_owner else 'Promote to Owner' }}" type="submit">
					<i class="fas fa-user{{'-cog' if is_owner else ''}} fa-xs"></i>
				</button>
				<button class="button icon is-danger" title="Remove User" type="submit">
					<i class="fas fa-trash fa-xs"></i>
				</button>
			</div>
		</div>
	</div>
</form>
{% endfor %}
</p>

<p>
<h4 class="title is-4">Delete List</h4>

<form action="{{ url_for('.delete', list_id=mailing_list.list_id) }}" method="post">
	<p>This permanently deletes all memberships and settings.
	Please, type the list's address in all-caps ({{ tenca_macros.css_codify(mailing_list.fqdn_listname, other_classes="is-uppercase", other_attrs='id=confirmation_reference') }}) to confirm:</p>

	<div class="field has-addons">
		<div class="control is-expanded">
		  <input id="confirmation_phrase" class="input" name="confirmation_phrase" placeholder="Type in upper-case address to confirm">
		</div>
		<div class="control">
		  <button id="delete_submit" class="button is-danger" name="delete_submit" title="Permanently Delete List" type="submit" disabled>
			Delete
		  </a>
		</div>
	  </div>
</form>
</p>


{% endblock %}